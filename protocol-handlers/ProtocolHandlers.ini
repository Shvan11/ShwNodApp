# ============================================
# Protocol Handlers Configuration
# ============================================
#
# This file configures the behavior of protocol handlers
# installed on this machine.
#
# Location: C:\Windows\ProtocolHandlers.ini
#
# ============================================

[Paths]
# Base folder where patient records are stored
# This path is used by CS Imaging protocol to locate patient OPG folders
#
# Format: \\ServerName\ShareName or C:\LocalPath
# Example: \\Clinic\clinic1
#
PatientsFolder=\\Clinic\clinic1

# Access Database for Labels/Reports
# This is used by the Universal Protocol Handler when launching MS Access
# You can reference this with the special variable {AccessDatabase}
#
# Format: Full path to .accdb file
# Example: C:\S_O\labels.accdb
#
AccessDatabase=C:\S_O\labels.accdb

# ============================================
# Universal Protocol Handler - Application Aliases
# ============================================
#
# Define shortcuts for commonly-used applications
# Format: AliasName=Full\Path\To\Application.exe
#
# Usage: launch://alias?args=arg1|arg2|arg3
#

[Applications]
# Microsoft Office Applications
msaccess=C:\Program Files\Microsoft Office\root\Office16\MSACCESS.EXE
excel=C:\Program Files\Microsoft Office\root\Office16\EXCEL.EXE
word=C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE
powerpoint=C:\Program Files\Microsoft Office\root\Office16\POWERPNT.EXE

# Common System Applications
notepad=C:\Windows\System32\notepad.exe
calc=C:\Windows\System32\calc.exe
mspaint=C:\Windows\System32\mspaint.exe

# Add your custom applications here
# Example:
# myapp=C:\CustomApps\MyApplication.exe

# ============================================
# Universal Protocol - Security Settings
# ============================================
#
# Control which applications can be launched via launch:// protocol
#

[Security]
# Set to 'true' to only allow applications listed in [Applications] section
# Set to 'false' to allow any executable path (less secure)
#
# Default: false (allows full paths like launch://C:/path/to/app.exe)
UseWhitelist=false

# ============================================
# How to Edit This File
# ============================================
#
# 1. Open Notepad as Administrator
# 2. File → Open → C:\Windows\ProtocolHandlers.ini
# 3. Make your changes:
#    - Update PatientsFolder for CS Imaging
#    - Add/modify application aliases in [Applications]
#    - Toggle UseWhitelist for security
# 4. Save the file
# 5. No restart needed - changes take effect immediately
#
# ============================================
# Universal Protocol Usage Examples
# ============================================
#
# Using an alias:
#   launch://msaccess?args=C:\database.accdb
#
# Using full path:
#   launch://C:/Program%20Files/App/app.exe?args=file.txt
#
# Multiple arguments (separated by pipe |):
#   launch://msaccess?args=C:\S_O\labels.accdb|/cmd|frmLabels|ID=123
#
# Using {AccessDatabase} variable (from [Paths] section):
#   launch://msaccess?args={AccessDatabase}|/cmd|frmLabels|ID=123
#
# Using {PatientsFolder} variable:
#   launch://explorer?args={PatientsFolder}\Patient123
#
# From JavaScript:
#   window.location.href = 'launch://msaccess?args=' +
#     encodeURIComponent('{AccessDatabase}|/cmd|frmLabels|ID=123');
#
# ============================================
# Troubleshooting
# ============================================
#
# Universal Protocol Issues:
# - Verify application paths in [Applications] are correct
# - Check that UseWhitelist setting matches your security needs
# - Ensure paths use backslashes (C:\Path\) not forward slashes
# - Use pipe | to separate multiple arguments
#
# CS Imaging Issues:
# - Verify this file exists at C:\Windows\ProtocolHandlers.ini
# - Verify the [Paths] section exists
# - Verify PatientsFolder=\\YourPath is set
# - Check that the network path is accessible
#
# ============================================
