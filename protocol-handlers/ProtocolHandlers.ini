# Protocol Handlers Configuration
# Location: C:\Windows\ProtocolHandlers.ini

[Paths]
# Base folder for patient records (used by CS Imaging and Dolphin protocols)
# Format: \\ServerName\ShareName or C:\LocalPath
PatientsFolder=\\Clinic\clinic1

# Access Database for labels/reports (used by Universal Protocol)
# Variable: {AccessDatabase}
AccessDatabase=C:\S_O\labels.accdb

# Dolphin Imaging installation path (contains DolCtrl.exe and Dolphin.ini)
# Format: C:\Path\ (with trailing backslash)
DolphinPath=C:\Dolphin\

# Default folder for photo import (memory card or camera folder)
# Used by dolphin: protocol with action=photos
MemoryCardPath=D:\DCIM

# ============================================
# RunAsDate Configuration (for legacy Dolphin)
# ============================================
# Some PCs cannot run Dolphin directly due to licensing/date restrictions.
# On these machines, Dolphin must be launched via RunAsDate utility which
# spoofs the system date to allow the software to run.
#
# When UseRunAsDate=true:
#   - Uses dolphin64.exe instead of DolCtrl.exe
#   - Launches via: RunAsDate.exe /immediate /movetime 29\07\2021 00:00:00 "dolphin64.exe"
#
# When UseRunAsDate=false (default):
#   - Uses standard DolCtrl.exe launch (normal Dolphin installations)
#
# UseRunAsDate: Set to true on PCs requiring RunAsDate workaround
# RunAsDatePath: Full path to RunAsDate.exe utility (e.g., D:\Dol_Crack\Runasdate\RunAsDate.exe)
UseRunAsDate=false
RunAsDatePath=D:\Dol_Crack\Runasdate\RunAsDate.exe

# 3Shape Unite configuration
# TShapePath: Full path to 3Shape Unite executable
# TShapeAllowedComputer: Computer name restriction (leave empty for no restriction)
TShapePath=C:\Program Files\3Shape\Unite\3ShapeUnite.exe
TShapeAllowedComputer=WORK_PC


[Applications]
# Application aliases for Universal Protocol (launch://)
# Format: alias=Full\Path\To\Application.exe
msaccess=C:\Program Files\Microsoft Office\root\Office16\MSACCESS.EXE

# Add more applications as needed
# excel=C:\Program Files\Microsoft Office\root\Office16\EXCEL.EXE


# ============================================
# Usage Examples
# ============================================

# Using alias with variable:
#   launch://msaccess?args={AccessDatabase}|/cmd|frmLabels|ID=123

# From JavaScript:
#   window.location.href = 'launch://msaccess?args=' +
#     encodeURIComponent('{AccessDatabase}|/cmd|frmLabels|ID=123');


# ============================================
# How to Edit
# ============================================

# 1. Open as Administrator: notepad C:\Windows\ProtocolHandlers.ini
# 2. Edit settings (paths, applications, security)
# 3. Save file
# 4. Changes apply immediately (no restart)


# ============================================
# Troubleshooting
# ============================================

# Universal Protocol:
# - Verify application paths are correct
# - Use backslashes (C:\Path\) not forward slashes
# - Separate arguments with pipe |
# - Only aliases from [Applications] are allowed (security)

# CS Imaging / Dolphin:
# - Verify file exists: C:\Windows\ProtocolHandlers.ini
# - Check PatientsFolder path is accessible
# - Test network path: explorer \\Clinic\clinic1
